[
  {
    "objectID": "Homework-8.html",
    "href": "Homework-8.html",
    "title": "Homework-8",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.3.0 ──\n✔ broom        1.0.9     ✔ rsample      1.3.1\n✔ dials        1.4.1     ✔ tune         1.3.0\n✔ infer        1.0.9     ✔ workflows    1.2.0\n✔ modeldata    1.5.0     ✔ workflowsets 1.1.1\n✔ parsnip      1.3.2     ✔ yardstick    1.3.2\n✔ recipes      1.3.1     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nlibrary(broom)\n\n# Read in Seoul Bike Data use read.csv; had to assign fileEncoding to get the dataset to load in\nbike_data &lt;- read.csv(\"SeoulBikeData.csv\", header = TRUE, fileEncoding = \"latin1\")\n\n\nEDA\n\nChecking the Data\n\n# I'm starting by checking for missingness in the data using is.na to see the number of missing values. No missing values were found. \nsum(is.na(bike_data))\n\n[1] 0\n\ncolSums(is.na(bike_data))\n\n                     Date         Rented.Bike.Count                      Hour \n                        0                         0                         0 \n          Temperature..C.               Humidity...          Wind.speed..m.s. \n                        0                         0                         0 \n         Visibility..10m. Dew.point.temperature..C.   Solar.Radiation..MJ.m2. \n                        0                         0                         0 \n             Rainfall.mm.             Snowfall..cm.                   Seasons \n                        0                         0                         0 \n                  Holiday           Functioning.Day \n                        0                         0 \n\n\n\n# Now I need to check the data structure. The numeric variables are confirmed numeric, but the categorical variables were read in as character strings, and the date is also character strings, so I need to convert both of those. I also checked the categorical variables for unique values, to confirm consistency in the dataset. \nstr(bike_data)\n\n'data.frame':   8760 obs. of  14 variables:\n $ Date                     : chr  \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" ...\n $ Rented.Bike.Count        : int  254 204 173 107 78 100 181 460 930 490 ...\n $ Hour                     : int  0 1 2 3 4 5 6 7 8 9 ...\n $ Temperature..C.          : num  -5.2 -5.5 -6 -6.2 -6 -6.4 -6.6 -7.4 -7.6 -6.5 ...\n $ Humidity...              : int  37 38 39 40 36 37 35 38 37 27 ...\n $ Wind.speed..m.s.         : num  2.2 0.8 1 0.9 2.3 1.5 1.3 0.9 1.1 0.5 ...\n $ Visibility..10m.         : int  2000 2000 2000 2000 2000 2000 2000 2000 2000 1928 ...\n $ Dew.point.temperature..C.: num  -17.6 -17.6 -17.7 -17.6 -18.6 -18.7 -19.5 -19.3 -19.8 -22.4 ...\n $ Solar.Radiation..MJ.m2.  : num  0 0 0 0 0 0 0 0 0.01 0.23 ...\n $ Rainfall.mm.             : num  0 0 0 0 0 0 0 0 0 0 ...\n $ Snowfall..cm.            : num  0 0 0 0 0 0 0 0 0 0 ...\n $ Seasons                  : chr  \"Winter\" \"Winter\" \"Winter\" \"Winter\" ...\n $ Holiday                  : chr  \"No Holiday\" \"No Holiday\" \"No Holiday\" \"No Holiday\" ...\n $ Functioning.Day          : chr  \"Yes\" \"Yes\" \"Yes\" \"Yes\" ...\n\nsummary(bike_data)\n\n     Date           Rented.Bike.Count      Hour       Temperature..C. \n Length:8760        Min.   :   0.0    Min.   : 0.00   Min.   :-17.80  \n Class :character   1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50  \n Mode  :character   Median : 504.5    Median :11.50   Median : 13.70  \n                    Mean   : 704.6    Mean   :11.50   Mean   : 12.88  \n                    3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50  \n                    Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n  Humidity...    Wind.speed..m.s. Visibility..10m. Dew.point.temperature..C.\n Min.   : 0.00   Min.   :0.000    Min.   :  27     Min.   :-30.600          \n 1st Qu.:42.00   1st Qu.:0.900    1st Qu.: 940     1st Qu.: -4.700          \n Median :57.00   Median :1.500    Median :1698     Median :  5.100          \n Mean   :58.23   Mean   :1.725    Mean   :1437     Mean   :  4.074          \n 3rd Qu.:74.00   3rd Qu.:2.300    3rd Qu.:2000     3rd Qu.: 14.800          \n Max.   :98.00   Max.   :7.400    Max.   :2000     Max.   : 27.200          \n Solar.Radiation..MJ.m2.  Rainfall.mm.     Snowfall..cm.       Seasons         \n Min.   :0.0000          Min.   : 0.0000   Min.   :0.00000   Length:8760       \n 1st Qu.:0.0000          1st Qu.: 0.0000   1st Qu.:0.00000   Class :character  \n Median :0.0100          Median : 0.0000   Median :0.00000   Mode  :character  \n Mean   :0.5691          Mean   : 0.1487   Mean   :0.07507                     \n 3rd Qu.:0.9300          3rd Qu.: 0.0000   3rd Qu.:0.00000                     \n Max.   :3.5200          Max.   :35.0000   Max.   :8.80000                     \n   Holiday          Functioning.Day   \n Length:8760        Length:8760       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n\nunique(bike_data$Seasons)\n\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\nunique(bike_data$Holiday)\n\n[1] \"No Holiday\" \"Holiday\"   \n\nunique(bike_data$Functioning.Day)\n\n[1] \"Yes\" \"No\" \n\n\n\n# Next, I need to convert the Date column into an actual date using lubridate.\nbike_data &lt;- bike_data |&gt;\n  mutate(Date = dmy(Date))\n# Checking if it worked\nhead(bike_data$Date, 10)\n\n [1] \"2017-12-01\" \"2017-12-01\" \"2017-12-01\" \"2017-12-01\" \"2017-12-01\"\n [6] \"2017-12-01\" \"2017-12-01\" \"2017-12-01\" \"2017-12-01\" \"2017-12-01\"\n\nclass(bike_data$Date)\n\n[1] \"Date\"\n\n\n\n# Now I will convert the character variables into factors.\nbike_data &lt;- bike_data |&gt;\n  mutate(\n    Seasons = as.factor(Seasons),\n    Holiday = as.factor(Holiday),\n    Functioning.Day = as.factor(Functioning.Day)\n  )\n# Checking to see if it worked\nclass(bike_data$Seasons)\n\n[1] \"factor\"\n\nclass(bike_data$Holiday)\n\n[1] \"factor\"\n\nclass(bike_data$Functioning.Day)\n\n[1] \"factor\"\n\n\n\n# Simplify column names to make them easier to work with \ncolnames(bike_data) &lt;- (c(\"date\", \"bike_count\", \"hour\", \"temp\", \"humidity\", \"wind_speed\", \"visibility\", \"dew_point_temp\", \"solar_radiation\", \"rainfall\", \"snowfall\", \"seasons\", \"holiday\", \"functioning_day\"))\n# Checking new names\nhead(bike_data)\n\n        date bike_count hour temp humidity wind_speed visibility dew_point_temp\n1 2017-12-01        254    0 -5.2       37        2.2       2000          -17.6\n2 2017-12-01        204    1 -5.5       38        0.8       2000          -17.6\n3 2017-12-01        173    2 -6.0       39        1.0       2000          -17.7\n4 2017-12-01        107    3 -6.2       40        0.9       2000          -17.6\n5 2017-12-01         78    4 -6.0       36        2.3       2000          -18.6\n6 2017-12-01        100    5 -6.4       37        1.5       2000          -18.7\n  solar_radiation rainfall snowfall seasons    holiday functioning_day\n1               0        0        0  Winter No Holiday             Yes\n2               0        0        0  Winter No Holiday             Yes\n3               0        0        0  Winter No Holiday             Yes\n4               0        0        0  Winter No Holiday             Yes\n5               0        0        0  Winter No Holiday             Yes\n6               0        0        0  Winter No Holiday             Yes\n\n\n\n\nSummary Statistics\n\nsummary(bike_data)\n\n      date              bike_count          hour            temp       \n Min.   :2017-12-01   Min.   :   0.0   Min.   : 0.00   Min.   :-17.80  \n 1st Qu.:2018-03-02   1st Qu.: 191.0   1st Qu.: 5.75   1st Qu.:  3.50  \n Median :2018-06-01   Median : 504.5   Median :11.50   Median : 13.70  \n Mean   :2018-06-01   Mean   : 704.6   Mean   :11.50   Mean   : 12.88  \n 3rd Qu.:2018-08-31   3rd Qu.:1065.2   3rd Qu.:17.25   3rd Qu.: 22.50  \n Max.   :2018-11-30   Max.   :3556.0   Max.   :23.00   Max.   : 39.40  \n    humidity       wind_speed      visibility   dew_point_temp   \n Min.   : 0.00   Min.   :0.000   Min.   :  27   Min.   :-30.600  \n 1st Qu.:42.00   1st Qu.:0.900   1st Qu.: 940   1st Qu.: -4.700  \n Median :57.00   Median :1.500   Median :1698   Median :  5.100  \n Mean   :58.23   Mean   :1.725   Mean   :1437   Mean   :  4.074  \n 3rd Qu.:74.00   3rd Qu.:2.300   3rd Qu.:2000   3rd Qu.: 14.800  \n Max.   :98.00   Max.   :7.400   Max.   :2000   Max.   : 27.200  \n solar_radiation     rainfall          snowfall         seasons    \n Min.   :0.0000   Min.   : 0.0000   Min.   :0.00000   Autumn:2184  \n 1st Qu.:0.0000   1st Qu.: 0.0000   1st Qu.:0.00000   Spring:2208  \n Median :0.0100   Median : 0.0000   Median :0.00000   Summer:2208  \n Mean   :0.5691   Mean   : 0.1487   Mean   :0.07507   Winter:2160  \n 3rd Qu.:0.9300   3rd Qu.: 0.0000   3rd Qu.:0.00000                \n Max.   :3.5200   Max.   :35.0000   Max.   :8.80000                \n       holiday     functioning_day\n Holiday   : 432   No : 295       \n No Holiday:8328   Yes:8465       \n                                  \n                                  \n                                  \n                                  \n\n# Next, I will run some summary statistics on the bike data. I want to see the mean, median, standard deviation, and IQR for each variable. This code shows the summary statistics for all of the numeric variables. \nbike_data |&gt;\n  summarise(across(where(is.numeric), list(\"mean\" = mean, \"median\" = median, \"sd\" = sd, \"iqr\" = IQR), .names = \"{.fn}_{.col}\"))\n\n  mean_bike_count median_bike_count sd_bike_count iqr_bike_count mean_hour\n1        704.6021             504.5      644.9975         874.25      11.5\n  median_hour  sd_hour iqr_hour mean_temp median_temp  sd_temp iqr_temp\n1        11.5 6.922582     11.5  12.88292        13.7 11.94483       19\n  mean_humidity median_humidity sd_humidity iqr_humidity mean_wind_speed\n1      58.22626              57    20.36241           32        1.724909\n  median_wind_speed sd_wind_speed iqr_wind_speed mean_visibility\n1               1.5        1.0363            1.4        1436.826\n  median_visibility sd_visibility iqr_visibility mean_dew_point_temp\n1              1698      608.2987           1060            4.073813\n  median_dew_point_temp sd_dew_point_temp iqr_dew_point_temp\n1                   5.1          13.06037               19.5\n  mean_solar_radiation median_solar_radiation sd_solar_radiation\n1            0.5691107                   0.01          0.8687462\n  iqr_solar_radiation mean_rainfall median_rainfall sd_rainfall iqr_rainfall\n1                0.93     0.1486872               0    1.128193            0\n  mean_snowfall median_snowfall sd_snowfall iqr_snowfall\n1    0.07506849               0   0.4367462            0\n\n# I also want to see summary statistics for the categorical variables, so I will run each of these separately for seasons, holiday, and functioning day. \nbike_data |&gt;\n  group_by(seasons) |&gt;\n  summarise(across(where(is.numeric), list(\"mean\" = mean, \"median\" = median, \"sd\" = sd, \"iqr\" = IQR), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 4 × 41\n  seasons mean_bike_count median_bike_count sd_bike_count iqr_bike_count\n  &lt;fct&gt;             &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;\n1 Autumn             820.              764.          651.           956.\n2 Spring             730.              583           622.           899.\n3 Summer            1034.              906.          690.           916.\n4 Winter             226.              203           150.           195 \n# ℹ 36 more variables: mean_hour &lt;dbl&gt;, median_hour &lt;dbl&gt;, sd_hour &lt;dbl&gt;,\n#   iqr_hour &lt;dbl&gt;, mean_temp &lt;dbl&gt;, median_temp &lt;dbl&gt;, sd_temp &lt;dbl&gt;,\n#   iqr_temp &lt;dbl&gt;, mean_humidity &lt;dbl&gt;, median_humidity &lt;dbl&gt;,\n#   sd_humidity &lt;dbl&gt;, iqr_humidity &lt;dbl&gt;, mean_wind_speed &lt;dbl&gt;,\n#   median_wind_speed &lt;dbl&gt;, sd_wind_speed &lt;dbl&gt;, iqr_wind_speed &lt;dbl&gt;,\n#   mean_visibility &lt;dbl&gt;, median_visibility &lt;dbl&gt;, sd_visibility &lt;dbl&gt;,\n#   iqr_visibility &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;, …\n\nbike_data |&gt;\n  group_by(holiday) |&gt;\n  summarise(across(where(is.numeric), list(\"mean\" = mean, \"median\" = median, \"sd\" = sd, \"iqr\" = IQR), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 2 × 41\n  holiday    mean_bike_count median_bike_count sd_bike_count iqr_bike_count\n  &lt;fct&gt;                &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;\n1 Holiday               500.              240           571.           657.\n2 No Holiday            715.              524.          647.           873 \n# ℹ 36 more variables: mean_hour &lt;dbl&gt;, median_hour &lt;dbl&gt;, sd_hour &lt;dbl&gt;,\n#   iqr_hour &lt;dbl&gt;, mean_temp &lt;dbl&gt;, median_temp &lt;dbl&gt;, sd_temp &lt;dbl&gt;,\n#   iqr_temp &lt;dbl&gt;, mean_humidity &lt;dbl&gt;, median_humidity &lt;dbl&gt;,\n#   sd_humidity &lt;dbl&gt;, iqr_humidity &lt;dbl&gt;, mean_wind_speed &lt;dbl&gt;,\n#   median_wind_speed &lt;dbl&gt;, sd_wind_speed &lt;dbl&gt;, iqr_wind_speed &lt;dbl&gt;,\n#   mean_visibility &lt;dbl&gt;, median_visibility &lt;dbl&gt;, sd_visibility &lt;dbl&gt;,\n#   iqr_visibility &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;, …\n\nbike_data |&gt;\n  group_by(functioning_day) |&gt;\n  summarise(across(where(is.numeric), list(\"mean\" = mean, \"median\" = median, \"sd\" = sd, \"iqr\" = IQR), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 2 × 41\n  functioning_day mean_bike_count median_bike_count sd_bike_count iqr_bike_count\n  &lt;fct&gt;                     &lt;dbl&gt;             &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;\n1 No                           0                  0            0               0\n2 Yes                        729.               542          642.            870\n# ℹ 36 more variables: mean_hour &lt;dbl&gt;, median_hour &lt;int&gt;, sd_hour &lt;dbl&gt;,\n#   iqr_hour &lt;dbl&gt;, mean_temp &lt;dbl&gt;, median_temp &lt;dbl&gt;, sd_temp &lt;dbl&gt;,\n#   iqr_temp &lt;dbl&gt;, mean_humidity &lt;dbl&gt;, median_humidity &lt;int&gt;,\n#   sd_humidity &lt;dbl&gt;, iqr_humidity &lt;dbl&gt;, mean_wind_speed &lt;dbl&gt;,\n#   median_wind_speed &lt;dbl&gt;, sd_wind_speed &lt;dbl&gt;, iqr_wind_speed &lt;dbl&gt;,\n#   mean_visibility &lt;dbl&gt;, median_visibility &lt;int&gt;, sd_visibility &lt;dbl&gt;,\n#   iqr_visibility &lt;dbl&gt;, mean_dew_point_temp &lt;dbl&gt;, …\n\n#After running the functioning day code, I noticed that the rental count was zero on non-functional days, so I decided to remove these observations from the dataset before further analysis.\nbike_data &lt;- bike_data |&gt;\n  filter(functioning_day == \"Fun\" | functioning_day == \"Yes\")\n\n\n# Now I will summarize across the hours so each day has only one observation, to simplify the analysis. \nbike_summary &lt;- bike_data |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarise(\n    # Find sum of bike count, rainfall, and snowfall\n    bike_count = sum(bike_count),\n    rainfall = sum(rainfall),\n    snowfall = sum(snowfall),\n    # Find mean of all weather related variables\n    temp = mean(temp),\n    humidity = mean(humidity),\n    wind_speed = mean(wind_speed),\n    visibility = mean(visibility),\n    dew_point_temp = mean(dew_point_temp),\n    solar_radiation = mean(solar_radiation),\n    .groups = \"drop\"\n  )\n# Check if that worked\nbike_summary\n\n# A tibble: 353 × 12\n   date       seasons holiday    bike_count rainfall snowfall    temp humidity\n   &lt;date&gt;     &lt;fct&gt;   &lt;fct&gt;           &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;\n 1 2017-12-01 Winter  No Holiday       9539      0        0   -2.45       45.9\n 2 2017-12-02 Winter  No Holiday       8523      0        0    1.33       62.0\n 3 2017-12-03 Winter  No Holiday       7222      4        0    4.88       81.5\n 4 2017-12-04 Winter  No Holiday       8729      0.1      0   -0.304      52.5\n 5 2017-12-05 Winter  No Holiday       8307      0        0   -4.46       36.4\n 6 2017-12-06 Winter  No Holiday       6669      1.3      8.6  0.0458     70.8\n 7 2017-12-07 Winter  No Holiday       8549      0       10.4  1.09       67.5\n 8 2017-12-08 Winter  No Holiday       8032      0        0   -3.82       41.8\n 9 2017-12-09 Winter  No Holiday       7233      0        0   -0.846      46  \n10 2017-12-10 Winter  No Holiday       3453      4.1     32.5  1.19       69.7\n# ℹ 343 more rows\n# ℹ 4 more variables: wind_speed &lt;dbl&gt;, visibility &lt;dbl&gt;, dew_point_temp &lt;dbl&gt;,\n#   solar_radiation &lt;dbl&gt;\n\n\n\n\nNew Dataset - Summary Stats and Plots\n\n# Starting with this updated dataset, I will first do some summary stats. I found that the bike count variable ranged widely between days, and the weather variables showed reasonable daily averages and variability.\nbike_summary |&gt;\n  summarise(across(where(is.numeric), list(\"mean\" = mean, \"median\" = median, \"sd\" = sd, \"iqr\" = IQR), .names = \"{.fn}_{.col}\"))\n\n# A tibble: 1 × 36\n  mean_bike_count median_bike_count sd_bike_count iqr_bike_count mean_rainfall\n            &lt;dbl&gt;             &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;\n1          17485.             18563         9937.          19318          3.58\n# ℹ 31 more variables: median_rainfall &lt;dbl&gt;, sd_rainfall &lt;dbl&gt;,\n#   iqr_rainfall &lt;dbl&gt;, mean_snowfall &lt;dbl&gt;, median_snowfall &lt;dbl&gt;,\n#   sd_snowfall &lt;dbl&gt;, iqr_snowfall &lt;dbl&gt;, mean_temp &lt;dbl&gt;, median_temp &lt;dbl&gt;,\n#   sd_temp &lt;dbl&gt;, iqr_temp &lt;dbl&gt;, mean_humidity &lt;dbl&gt;, median_humidity &lt;dbl&gt;,\n#   sd_humidity &lt;dbl&gt;, iqr_humidity &lt;dbl&gt;, mean_wind_speed &lt;dbl&gt;,\n#   median_wind_speed &lt;dbl&gt;, sd_wind_speed &lt;dbl&gt;, iqr_wind_speed &lt;dbl&gt;,\n#   mean_visibility &lt;dbl&gt;, median_visibility &lt;dbl&gt;, sd_visibility &lt;dbl&gt;, …\n\n# Next, I calculated correlations between all numeric variables to identify which weather factors were most associated with bike rentals. \nbike_summary |&gt;\n  select(where(is.numeric)) |&gt;\n  cor(use = \"complete.obs\") |&gt;\n  round(2)\n\n                bike_count rainfall snowfall  temp humidity wind_speed\nbike_count            1.00    -0.24    -0.27  0.75     0.04      -0.19\nrainfall             -0.24     1.00    -0.02  0.14     0.53      -0.10\nsnowfall             -0.27    -0.02     1.00 -0.27     0.07       0.02\ntemp                  0.75     0.14    -0.27  1.00     0.40      -0.26\nhumidity              0.04     0.53     0.07  0.40     1.00      -0.23\nwind_speed           -0.19    -0.10     0.02 -0.26    -0.23       1.00\nvisibility            0.17    -0.22    -0.10  0.00    -0.56       0.21\ndew_point_temp        0.65     0.26    -0.21  0.96     0.63      -0.29\nsolar_radiation       0.74    -0.32    -0.23  0.55    -0.27       0.10\n                visibility dew_point_temp solar_radiation\nbike_count            0.17           0.65            0.74\nrainfall             -0.22           0.26           -0.32\nsnowfall             -0.10          -0.21           -0.23\ntemp                  0.00           0.96            0.55\nhumidity             -0.56           0.63           -0.27\nwind_speed            0.21          -0.29            0.10\nvisibility            1.00          -0.15            0.27\ndew_point_temp       -0.15           1.00            0.38\nsolar_radiation       0.27           0.38            1.00\n\n# The correlation matrix showed a few relationships. Bike rentals were strongly positively correlated with temperature, while humidity and rainfall showed negative correlations with rental counts. Other variables had weaker correlations, implying they have less influence on bike rentals. \n\n# To visualize these patterns, I created scatterplots and boxplots to see both numeric and categorical relationships. \n\n# Scatterplot - rentals vs temperature\nggplot(bike_summary, aes(x = temp, y = bike_count)) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n  labs(title = \"Bike Rentals vs Temperature\",\n       x = \"Average Temperature °C\",\n       y = \"Daily Bike Rentals\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n# Scatterplot - rentals vs humidity\nggplot(bike_summary, aes(x = humidity, y = bike_count)) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n  labs(title = \"Bike Rentals vs Humidity\",\n       x = \"Average Humidity (%)\",\n       y = \"Daily Bike Rentals\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n# Boxplot - rentals vs seasons\nggplot(bike_summary, aes(x = seasons, y = bike_count, fill = seasons)) +\n  geom_boxplot() +\n  labs(title = \"Bike Rentals by Season\",\n       x = \"Season\",\n       y = \"Daily Bike Rentals\") +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n# Boxplot - rentals vs holidays\nggplot(bike_summary, aes(x = holiday, y = bike_count, fill = holiday)) +\n  geom_boxplot() +\n  labs(title = \"Bike Rentals on Holidays vs Non-Holidays\",\n       x = \"Holiday Status\",\n       y = \"Daily Bike Rentals\") +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n# These plots all supported the correlations observed earlier. \n\n\n\n\nSplit the Data\n\n75/25 Split\n\n# Now, I want to split the cleaned and summarized dataset into training and testing subsets. I will set a seed value to ensure my results will be reproducible.\nset.seed(123)\n\n# 75/25 split, stratify by seasons\nbike_split &lt;- initial_split(bike_summary, \n                            prop = 0.75, \n                            strata = seasons)\n\n# Create the two datasets\nbike_train &lt;- training(bike_split)\nbike_test  &lt;- testing(bike_split)\n\n# Check sizes\nnrow(bike_train)\n\n[1] 263\n\nnrow(bike_test)\n\n[1] 90\n\n# Check distribution of seasons\nprop.table(table(bike_train$seasons))\n\n\n   Autumn    Spring    Summer    Winter \n0.2281369 0.2547529 0.2623574 0.2547529 \n\nprop.table(table(bike_test$seasons))\n\n\n   Autumn    Spring    Summer    Winter \n0.2333333 0.2555556 0.2555556 0.2555556 \n\n\n\n\nFitting MLR Models\n\n# Now I need to do a 10 fold split. Beforehand, I'm going to use my date column to create a weekday/weekend variable for later use\nbike_train &lt;- bike_train |&gt;\n  mutate(\n    day_of_week = wday(date, label = TRUE, abbr = FALSE),  # e.g. Monday, Tuesday, ...\n    day_type = if_else(day_of_week %in% c(\"Saturday\", \"Sunday\"), \"Weekend\", \"Weekday\"),\n    day_type = as.factor(day_type)\n  )\nbike_test &lt;- bike_test |&gt;\n  mutate(\n    day_of_week = wday(date, label = TRUE, abbr = FALSE),\n    day_type = if_else(day_of_week %in% c(\"Saturday\", \"Sunday\"), \"Weekend\", \"Weekday\"),\n    day_type = as.factor(day_type)\n  )\n# Test to see if it worked\nglimpse(bike_test)\n\nRows: 90\nColumns: 14\n$ date            &lt;date&gt; 2017-12-09, 2017-12-12, 2017-12-15, 2017-12-16, 2017-…\n$ seasons         &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, Winter, Winter…\n$ holiday         &lt;fct&gt; No Holiday, No Holiday, No Holiday, No Holiday, No Hol…\n$ bike_count      &lt;int&gt; 7233, 5496, 7198, 4632, 4334, 7184, 4027, 6967, 4714, …\n$ rainfall        &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.9, 0.0,…\n$ snowfall        &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 55.6, 7.7, 0.0, 0.0, 0.0, 4.5, 10.…\n$ temp            &lt;dbl&gt; -0.8458333, -9.4666667, -3.2791667, -5.2875000, -3.533…\n$ humidity        &lt;dbl&gt; 46.00000, 42.79167, 50.45833, 46.33333, 50.20833, 67.0…\n$ wind_speed      &lt;dbl&gt; 1.0791667, 2.0333333, 0.9833333, 2.9541667, 2.1708333,…\n$ visibility      &lt;dbl&gt; 1860.9583, 1966.7917, 1000.2083, 1514.8750, 1661.2083,…\n$ dew_point_temp  &lt;dbl&gt; -11.233333, -19.937500, -12.325000, -16.016667, -13.02…\n$ solar_radiation &lt;dbl&gt; 0.26333333, 0.28333333, 0.10041667, 0.26666667, 0.2754…\n$ day_of_week     &lt;ord&gt; Saturday, Tuesday, Friday, Saturday, Tuesday, Friday, …\n$ day_type        &lt;fct&gt; Weekend, Weekday, Weekday, Weekend, Weekday, Weekday, …\n\n\n\nRecipe 1\n\n# I'll start with recipe 1. \nrec1 &lt;- recipe(bike_count ~ ., data = bike_train) |&gt;\n  # Remove date\n  update_role(date, new_role = \"ID\") |&gt;\n  # Create dummy variables\n  step_dummy(all_nominal_predictors()) |&gt;\n  # Standardize numeric variables\n  step_normalize(all_numeric_predictors())\n# I wanted to check if the recipe worked here, so I checked and then commented it out. \n#rec1_prep &lt;- prep(rec1)\n#baked_data &lt;- bake(rec1_prep, new_data = NULL)\n#glimpse(baked_data)\n#summary(rec1_prep)\n\n\n\nRecipe 2\n\n# Next up is recipe 2. I did the same steps as before, but this time I added in interactions between seasons and holiday, seasons and temp, and temp and rainfall. I used starts with() for my seasons and holiday variables.\nrec2 &lt;- recipe(bike_count ~ ., data = bike_train) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_dummy(all_nominal_predictors()) |&gt;\n  step_normalize(all_numeric_predictors()) |&gt;\n  # Interactions\n  step_interact(terms = ~ starts_with(\"seasons_\"):starts_with(\"holiday_\") + starts_with(\"seasons_\"):temp + temp:rainfall)\n\n\n\nRecipe 3\n\n# For recipe 3, I did the same steps as in rec1 and rec2, but this time I added in quadratic terms for each numeric predictor with degree = 2, which allows my model to capture non-linear relationships between weather variables and bike rentals. To do this, I tried to use all_numeric_predictors(), but found that it wouldn't work because I was trying to apply step_poly() to variables that weren't continous numeric variables. I updated this to specify each variable I want to add in quadratic terms for.\nrec3 &lt;- recipe(bike_count ~ ., data = bike_train) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_dummy(all_nominal_predictors()) |&gt;\n  step_normalize(all_numeric_predictors()) |&gt;\n  step_interact(terms = ~ starts_with(\"seasons_\"):starts_with(\"holiday_\") + starts_with(\"seasons_\"):temp + temp:rainfall) |&gt;\n  step_poly(temp, humidity, wind_speed, visibility,\n            dew_point_temp, solar_radiation, rainfall, degree = 2)\n# Check that it works\n#rec3_prep &lt;- prep(rec3)\n#baked_rec3 &lt;- bake(rec3_prep, new_data = NULL)\n#glimpse(baked_rec3)\n\n\n\n\nFit the Models\n\n# Now I need to fit the multiple linear regression models using 10 fold cross validation on the training set. \n\nset.seed(123)\nbike_folds &lt;- vfold_cv(bike_train, v = 10, strata = seasons)\n\n# Define model specification\nlm_spec &lt;- linear_reg() |&gt;\n  set_engine(\"lm\")\n\n# Model 1\nset.seed(123)\nlm_fit1 &lt;- workflow() |&gt;\n  add_model(lm_spec) |&gt;\n  add_recipe(rec1) |&gt;\n  fit_resamples(resamples = bike_folds,\n                metrics = metric_set(rmse, rsq),\n                control = control_resamples(save_pred = TRUE))\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x10\n\n\n\n\n# Model 2\nset.seed(123)\nlm_fit2 &lt;- workflow() |&gt;\n  add_model(lm_spec) |&gt;\n  add_recipe(rec2) |&gt;\n  fit_resamples(resamples = bike_folds,\n                metrics = metric_set(rmse, rsq),\n                control = control_resamples(save_pred = TRUE))\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x10\n\n\n\n\n# Model 3\nset.seed(123)\nlm_fit3 &lt;- workflow() |&gt;\n  add_model(lm_spec) |&gt;\n  add_recipe(rec3) |&gt;\n  fit_resamples(resamples = bike_folds,\n                metrics = metric_set(rmse, rsq),\n                control = control_resamples(save_pred = TRUE))\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n# Compare the models\ncollect_metrics(lm_fit1)\n\n# A tibble: 2 × 6\n  .metric .estimator     mean     n  std_err .config             \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard   4193.       10 214.     Preprocessor1_Model1\n2 rsq     standard      0.827    10   0.0150 Preprocessor1_Model1\n\ncollect_metrics(lm_fit2)\n\n# A tibble: 2 × 6\n  .metric .estimator     mean     n  std_err .config             \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard   3144.       10 174.     Preprocessor1_Model1\n2 rsq     standard      0.900    10   0.0149 Preprocessor1_Model1\n\ncollect_metrics(lm_fit3)\n\n# A tibble: 2 × 6\n  .metric .estimator     mean     n  std_err .config             \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard   3030.       10 165.     Preprocessor1_Model1\n2 rsq     standard      0.908    10   0.0132 Preprocessor1_Model1\n\n# Combine models into comparison table\nmodel_results &lt;- bind_rows(\n  collect_metrics(lm_fit1) |&gt; mutate(model = \"Basic\"),\n  collect_metrics(lm_fit2) |&gt; mutate(model = \"Interactions\"),\n  collect_metrics(lm_fit3) |&gt; mutate(model = \"Interactions + Quadratics\")\n)\nmodel_results\n\n# A tibble: 6 × 7\n  .metric .estimator     mean     n  std_err .config              model         \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;         \n1 rmse    standard   4193.       10 214.     Preprocessor1_Model1 Basic         \n2 rsq     standard      0.827    10   0.0150 Preprocessor1_Model1 Basic         \n3 rmse    standard   3144.       10 174.     Preprocessor1_Model1 Interactions  \n4 rsq     standard      0.900    10   0.0149 Preprocessor1_Model1 Interactions  \n5 rmse    standard   3030.       10 165.     Preprocessor1_Model1 Interactions …\n6 rsq     standard      0.908    10   0.0132 Preprocessor1_Model1 Interactions …\n\n# After comparing the results of the multiple linear regression models, I found that model 1 (using basic predictors) produced an RMSE of 4193 and RSQ of .83, model 2 (adding interaction terms) produced RMSE of 3144 and RSQ of .90, and model 3 (adding quadratic terms) produced RMSE of 3030 and RSQ of .91 indicating the best predictive performance. I selected model 3 as the final model to fit and evaluate. \n\n\n# Fit the best model to the full training set\nfinal_wf &lt;- workflow() |&gt;\n  add_model(lm_spec) |&gt;\n  add_recipe(rec3)\nfinal_fit &lt;- final_wf |&gt;\n  fit(data = bike_train)\n# Predict on test data\nfinal_predictions &lt;- predict(final_fit, new_data = bike_test) |&gt;\n  bind_cols(bike_test |&gt; select(bike_count))\n\nWarning in predict.lm(object = object$fit, newdata = new_data, type =\n\"response\", : prediction from rank-deficient fit; consider predict(.,\nrankdeficient=\"NA\")\n\n# Compute RMSE metric on test set\nmetrics(final_predictions, truth = bike_count, estimate = .pred)\n\n# A tibble: 3 × 3\n  .metric .estimator .estimate\n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;\n1 rmse    standard    2957.   \n2 rsq     standard       0.915\n3 mae     standard    2191.   \n\n# Extract fitted model \nfinal_fit_extract &lt;- extract_fit_parsnip(final_fit)\ntidy(final_fit_extract)\n\n# A tibble: 34 × 5\n   term               estimate std.error statistic  p.value\n   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)         19922.      1577.    12.6   3.83e-28\n 2 snowfall             -148.       213.    -0.698 4.86e- 1\n 3 seasons_Spring      -2102.       262.    -8.01  5.73e-14\n 4 seasons_Summer       6267.       961.     6.52  4.37e-10\n 5 seasons_Winter      -5156.       995.    -5.18  4.85e- 7\n 6 holiday_No.Holiday    937.       216.     4.35  2.05e- 5\n 7 day_of_week_1         484.       180.     2.69  7.72e- 3\n 8 day_of_week_2       -1142.       181.    -6.32  1.35e- 9\n 9 day_of_week_3         -56.1      184.    -0.304 7.61e- 1\n10 day_of_week_4         -99.0      178.    -0.555 5.79e- 1\n# ℹ 24 more rows\n\n# I extracted the fitted linear model from the workflow using extract_fit_parsnip() and displayed the coefficients using tidy(). The resulting table shows the estimated effects of each predictor on bike rentals. Overall, the model captures realistic relationships between environmental conditions and cycling demand, providing a strong predictive framework for future rental forecasting."
  }
]